<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulaire de Don - REGEN</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Animations personnalisées */
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            0% { opacity: 0; transform: translateY(10px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        .hover-scale {
            transition: transform 0.2s ease;
        }
        .hover-scale:hover {
            transform: scale(1.05);
        }
        .pulse {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.03); }
            100% { transform: scale(1); }
        }
        .card {
            transition: all 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        .svg-icon {
            width: 24px;
            height: 24px;
            margin-right: 8px;
            fill: #059669;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-100 to-green-100 flex items-center justify-center min-h-screen">
<div class="bg-white p-12 rounded-3xl shadow-2xl w-full max-w-4xl">
    <!-- Logo REGEN -->
    <div class="flex justify-center mb-10">
        <img src="assets/logo-regen.png" alt="REGEN Logo" class="h-20 hover-scale">
    </div>
    <h2 class="text-4xl font-extrabold mb-10 text-center text-blue-900">Formulaire de Don - REGEN</h2>
    <form id="donationForm" onsubmit="handleSubmit(event)" class="space-y-10" enctype="multipart/form-data">
        <!-- Groupe sanguin -->
        <div class="card bg-gray-50 p-6 rounded-xl">
            <label for="bloodGroup" class="block text-sm font-medium text-gray-700 flex items-center">
                <svg class="svg-icon" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                Groupe sanguin <span class="text-red-500">*</span>
            </label>
            <select id="bloodGroup" name="bloodGroup" required class="mt-2 block w-full p-4 border border-gray-200 rounded-lg focus:ring-green-500 focus:border-green-500">
                <option value="" disabled selected>Sélectionnez votre groupe sanguin</option>
                <option value="A+">A+</option>
                <option value="A-">A-</option>
                <option value="B+">B+</option>
                <option value="B-">B-</option>
                <option value="AB+">AB+</option>
                <option value="AB-">AB-</option>
                <option value="O+">O+</option>
                <option value="O-">O-</option>
            </select>
        </div>

        <!-- Types d'organes -->
        <div class="card bg-gray-50 p-6 rounded-xl">
            <label class="block text-sm font-medium text-gray-700">Organes à donner <span class="text-red-500">*</span></label>
            <div class="mt-3 space-y-4">
                <label class="inline-flex items-center hover-scale">
                    <input type="checkbox" name="organs" value="coeur" class="h-5 w-5 text-green-600 focus:ring-green-500 border-gray-300 rounded" required>
                    <span class="ml-2 text-gray-700">Cœur</span>
                </label>
                <label class="inline-flex items-center hover-scale">
                    <input type="checkbox" name="organs" value="foie" class="h-5 w-5 text-green-600 focus:ring-green-500 border-gray-300 rounded">
                    <span class="ml-2 text-gray-700">Foie</span>
                </label>
                <label class="inline-flex items-center hover-scale">
                    <input type="checkbox" name="organs" value="reins" class="h-5 w-5 text-green-600 focus:ring-green-500 border-gray-300 rounded">
                    <span class="ml-2 text-gray-700">Reins</span>
                </label>
                <label class="inline-flex items-center hover-scale">
                    <input type="checkbox" name="organs" value="poumons" class="h-5 w-5 text-green-600 focus:ring-green-500 border-gray-300 rounded">
                    <span class="ml-2 text-gray-700">Poumons</span>
                </label>
                <label class="inline-flex items-center hover-scale">
                    <input type="checkbox" name="organs" value="pancreas" class="h-5 w-5 text-green-600 focus:ring-green-500 border-gray-300 rounded">
                    <span class="ml-2 text-gray-700">Pancréas</span>
                </label>
                <label class="inline-flex items-center hover-scale">
                    <input type="checkbox" name="organs" value="autre" id="organOther" class="h-5 w-5 text-green-600 focus:ring-green-500 border-gray-300 rounded">
                    <span class="ml-2 text-gray-700">Autre</span>
                </label>
                <div id="otherOrganContainer" class="hidden mt-3">
                    <input type="text" id="otherOrgan" name="otherOrgan" class="block w-full p-4 border border-gray-200 rounded-lg focus:ring-green-500 focus:border-green-500" placeholder="Précisez l'organe">
                </div>
            </div>
        </div>

        <!-- Taille et Poids -->
        <div class="card bg-gray-50 p-6 rounded-xl grid grid-cols-2 gap-6">
            <div>
                <label for="height" class="block text-sm font-medium text-gray-700">Taille (cm) <span class="text-red-500">*</span></label>
                <input type="number" id="height" name="height" required min="100" max="250" class="mt-2 block w-full p-4 border border-gray-200 rounded-lg focus:ring-green-500 focus:border-green-500" placeholder="Ex: 170">
            </div>
            <div>
                <label for="weight" class="block text-sm font-medium text-gray-700">Poids (kg) <span class="text-red-500">*</span></label>
                <input type="number" id="weight" name="weight" required min="30" max="200" class="mt-2 block w-full p-4 border border-gray-200 rounded-lg focus:ring-green-500 focus:border-green-500" placeholder="Ex: 70">
            </div>
        </div>

        <!-- Document médical -->
        <div class="card bg-gray-50 p-6 rounded-xl">
            <label for="medicalCertificate" class="block text-sm font-medium text-gray-700">Certificat médical <span class="text-red-500">*</span></label>
            <input type="file" id="medicalCertificate" name="medicalCertificate" accept=".pdf,.jpg,.png" required class="mt-2 block w-full p-4 border border-gray-200 rounded-lg focus:ring-green-500 focus:border-green-500">
            <p class="text-sm text-gray-500 mt-2">Formats acceptés : PDF, JPG, PNG (max 5MB)</p>
        </div>

        <!-- Localisation -->
        <div class="card bg-gray-50 p-6 rounded-xl">
            <label for="location" class="block text-sm font-medium text-gray-700">Localisation <span class="text-red-500">*</span></label>
            <input type="text" id="location" name="location" required class="mt-2 block w-full p-4 border border-gray-200 rounded-lg focus:ring-green-500 focus:border-green-500" placeholder="Ex: Rabat, Maroc">
        </div>

        <!-- Méthode de contact -->
        <div class="card bg-gray-50 p-6 rounded-xl">
            <label for="contactMethod" class="block text-sm font-medium text-gray-700">Méthode de contact <span class="text-red-500">*</span></label>
            <select id="contactMethod" name="contactMethod" required class="mt-2 block w-full p-4 border border-gray-200 rounded-lg focus:ring-green-500 focus:border-green-500">
                <option value="" disabled selected>Choisissez une méthode</option>
                <option value="email">Email</option>
                <option value="telephone">Téléphone</option>
            </select>
            <div id="emailContainer" class="hidden mt-4">
                <input type="email" id="contactEmail" name="contactEmail" class="block w-full p-4 border border-gray-200 rounded-lg focus:ring-green-500 focus:border-green-500" placeholder="Ex: exemple@domaine.com">
            </div>
            <div id="phoneContainer" class="hidden mt-4">
                <input type="tel" id="contactPhone" name="contactPhone" class="block w-full p-4 border border-gray-200 rounded-lg focus:ring-green-500 focus:border-green-500" placeholder="Ex: +33 6 12 34 56 78">
            </div>
        </div>

        <!-- État de santé des organes -->
        <div class="card bg-gray-50 p-6 rounded-xl">
            <label for="organHealth" class="block text-sm font-medium text-gray-700">État de santé des organes <span class="text-red-500">*</span></label>
            <select id="organHealth" name="organHealth" required class="mt-2 block w-full p-4 border border-gray-200 rounded-lg focus:ring-green-500 focus:border-green-500">
                <option value="" disabled selected>Sélectionnez l'état</option>
                <option value="excellent">Excellent</option>
                <option value="bon">Bon</option>
                <option value="vérifié">Vérifié par un médecin</option>
                <option value="autre">Autre (précisez dans les commentaires)</option>
            </select>
        </div>

        <!-- Antécédents médicaux -->
        <div class="card bg-gray-50 p-6 rounded-xl">
            <label for="medicalHistory" class="block text-sm font-medium text-gray-700">Antécédents médicaux <span class="text-red-500">*</span></label>
            <textarea id="medicalHistory" name="medicalHistory" required rows="4" class="mt-2 block w-full p-4 border border-gray-200 rounded-lg focus:ring-green-500 focus:border-green-500" placeholder="Décrivez vos antécédents médicaux (maladies, chirurgies, etc.)"></textarea>
        </div>

        <!-- Fréquence/Disponibilité -->
        <div class="card bg-gray-50 p-6 rounded-xl">
            <label for="frequency" class="block text-sm font-medium text-gray-700">Fréquence/Disponibilité <span class="text-red-500">*</span></label>
            <select id="frequency" name="frequency" required class="mt-2 block w-full p-4 border border-gray-200 rounded-lg focus:ring-green-500 focus:border-green-500">
                <option value="" disabled selected>Sélectionnez la fréquence</option>
                <option value="ponctuel">Ponctuel</option>
                <option value="régulier">Régulier (précisez dans les commentaires)</option>
                <option value="en_attente">En attente de confirmation</option>
            </select>
        </div>

        <!-- Statut du donneur -->
        <div class="card bg-gray-50 p-6 rounded-xl">
            <label for="status" class="block text-sm font-medium text-gray-700">Statut du donneur <span class="text-red-500">*</span></label>
            <select id="status" name="status" required class="mt-2 block w-full p-4 border border-gray-200 rounded-lg focus:ring-green-500 focus:border-green-500">
                <option value="" disabled selected>Sélectionnez votre statut</option>
                <option value="vivant">Donneur vivant</option>
                <option value="decede">Donneur après décès</option>
                <option value="en_attente">En attente de confirmation</option>
            </select>
        </div>

        <!-- Typage HLA -->
        <div class="card bg-gray-50 p-6 rounded-xl">
            <label for="hla" class="block text-sm font-medium text-gray-700">Typage HLA</label>
            <input type="text" id="hla" name="hla" class="mt-2 block w-full p-4 border border-gray-200 rounded-lg focus:ring-green-500 focus:border-green-500" placeholder="Ex: HLA-A*02:01">
            <p class="text-sm text-gray-500 mt-2">Facultatif, fourni par un médecin si disponible</p>
        </div>

        <!-- Allergies -->
        <div class="card bg-gray-50 p-6 rounded-xl">
            <label for="allergies" class="block text-sm font-medium text-gray-700">Allergies</label>
            <textarea id="allergies" name="allergies" rows="3" class="mt-2 block w-full p-4 border border-gray-200 rounded-lg focus:ring-green-500 focus:border-green-500" placeholder="Listez vos allergies, si applicable"></textarea>
        </div>

        <!-- Contact d'urgence -->
        <div class="card bg-gray-50 p-6 rounded-xl">
            <label for="emergencyContact" class="block text-sm font-medium text-gray-700">Contact d'urgence <span class="text-red-500">*</span></label>
            <input type="text" id="emergencyContact" name="emergencyContact" required class="mt-2 block w-full p-4 border border-gray-200 rounded-lg focus:ring-green-500 focus:border-green-500" placeholder="Ex: +212 6 00 00 00 00 ou email">
        </div>

        <!-- Consentement -->
        <div class="card bg-gray-50 p-6 rounded-xl">
            <label class="inline-flex items-center">
                <input type="checkbox" id="consent" name="consent" required class="h-5 w-5 text-green-600 focus:ring-green-500 border-gray-300 rounded">
                <span class="ml-2 text-sm text-gray-700">Je consens explicitement au don de mes organes ou sang conformément aux lois en vigueur <span class="text-red-500">*</span></span>
            </label>
        </div>

        <!-- Commentaire -->
        <div class="card bg-gray-50 p-6 rounded-xl">
            <label for="comments" class="block text-sm font-medium text-gray-700">Commentaires ou instructions spéciales</label>
            <textarea id="comments" name="comments" rows="42" class="mt-2 block w-full p-4 border border-gray-200 rounded-lg focus:ring-green-500 focus:border-green-500" placeholder="Entrez des informations supplémentaires si nécessaire"></textarea>
        </div>

        <!-- Bouton de soumission -->
        <div class="card bg-gray-50 p-6 rounded-xl">
            <button type="submit" class="w-full bg-green-600 text-white p-4 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 pulse hover-scale">SouSoutenir la vie, donner un don</button>
        </div>
    </form>
</div>

<script>
    // Gestion du champ "Autre" pour les organes
    const organOtherCheckbox = document.getElementById('organOther');
    const otherOrganContainer = document.getElementById('otherOrganContainer');
    const otherOrganInput = document.getElementById('otherOrgan');

    organOtherCheckbox.addEventListener('change', () => {
        if (organOtherCheckbox.checked) {
            otherOrganContainer.classList.remove('hidden');
            otherOrganContainer.classList.add('fade-in');
            otherOrganInput.required = true;
        } else {
            otherOrganContainer.classList.add('hidden');
            otherOrganContainer.classList.remove('fade-in');
            otherOrganInput.required = false;
            otherOrganInput.value = '';
        }
    });

    // Gestion de la méthode de contact
    const contactMethodSelect = document.getElementById('contactMethod');
    const emailContainer = document.getElementById('emailContainer');
    const phoneContainer = document.getElementById('phoneContainer');
    const contactEmailInput = document.getElementById('contactEmail');
    const contactPhoneInput = document.getElementById('contactPhone');

    contactMethodSelect.addEventListener('change', () => {
        if (contactMethodSelect.value === 'email') {
            emailContainer.classList.remove('hidden');
            emailContainer.classList.add('fade-in');
            phoneContainer.classList.add('hidden');
            contactEmailInput.required = true;
            contactPhoneInput.required = false;
        } else if (contactMethodSelect.value === 'telephone') {
            phoneContainer.classList.remove('hidden');
            phoneContainer.classList.add('fade-in');
            emailContainer.classList.add('hidden');
            contactPhoneInput.required = true;
            contactEmailInput.required = false;
        } else {
            emailContainer.classList.add('hidden');
            phoneContainer.classList.add('hidden');
            contactEmailInput.required = false;
            contactPhoneInput.required = false;
        }
    });

    function handleSubmit(event) {
        event.preventDefault();
        const form = document.getElementById('donationForm');
        const bloodGroup = form.bloodGroup.value;
        const organs = Array.from(form.querySelectorAll('input[name="organs"]:checked')).map(input => input.value);
        const otherOrgan = organOtherCheckbox.checked ? form.otherOrgan.value : '';
        const height = form.height.value;
        const weight = form.weight.value;
        const medicalCertificate = form.medicalCertificate.files[0];
        const location = form.location.value;
        const contactMethod = form.contactMethod.value;
        const contactEmail = form.contactEmail.value;
        const contactPhone = form.contactPhone.value;
        const organHealth = form.organHealth.value;
        const medicalHistory = form.medicalHistory.value;
        const frequency = form.frequency.value;
        const status = form.status.value;
        const consent = form.consent.checked;
        const emergencyContact = form.emergencyContact.value;

        // Validation
        if (!bloodGroup || organs.length === 0 || !height || !weight || !medicalCertificate || !location || !contactMethod || !organHealth || !medicalHistory || !frequency || !status || !consent || !emergencyContact) {
            alert('Veuillez remplir tous les champs obligatoires.');
            return;
        }
        if (organOtherCheckbox.checked && !otherOrgan) {
            alert('Veuillez préciser l\'organe pour l\'option "Autre".');
            return;
        }
        if (contactMethod === 'email' && !contactEmail) {
            alert('Veuillez fournir une adresse email.');
            return;
        }
        if (contactMethod === 'telephone' && !contactPhone) {
            alert('Veuillez fournir un numéro de téléphone.');
            return;
        }
        const allowedTypes = ['application/pdf', 'image/jpeg', 'image/png'];
        if (!allowedTypes.includes(medicalCertificate.type)) {
            alert('Le certificat médical doit être un fichier PDF, JPG ou PNG.');
            return;
        }
        if (medicalCertificate.size > 5 * 1024 * 1024) {
            alert('Le fichier ne doit pas dépasser 5MB.');
            return;
        }

        // Collecte des données
        const formData = new FormData();
        formData.append('bloodGroup', bloodGroup);
        formData.append('organs', JSON.stringify(organs));
        if (otherOrgan) formData.append('otherOrgan', otherOrgan);
        formData.append('height', height);
        formData.append('weight', weight);
        formData.append('medicalCertificate', medicalCertificate);
        formData.append('location', location);
        formData.append('contactMethod', contactMethod);
        if (contactEmail) formData.append('contactEmail', contactEmail);
        if (contactPhone) formData.append('contactPhone', contactPhone);
        formData.append('organHealth', organHealth);
        formData.append('medicalHistory', medicalHistory);
        formData.append('frequency', frequency);
        formData.append('status', status);
        formData.append('hla', form.hla.value);
        formData.append('allergies', form.allergies.value);
        formData.append('emergencyContact', emergencyContact);
        formData.append('consent', consent);
        formData.append('comments', form.comments.value);

        // Simulation de l'envoi des données (remplacez par votre logique d'API)
        console.log('Données du formulaire :', Object.fromEntries(formData));
        alert('Formulaire soumis avec succès !');
        form.reset();
        otherOrganContainer.classList.add('hidden');
        organOtherCheckbox.checked = false;
        emailContainer.classList.add('hidden');
        phoneContainer.classList.add('hidden');
    }
</script>
</body>
</html>